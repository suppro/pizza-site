# Совместимость с существующими данными

## Обновления для работы с существующей БД

### 1. Способы оплаты и доставки

В вашей БД используются следующие значения:

**Способы оплаты:**
- `bank_transfer` → отображается как "Банковский перевод"
- `cash_on_delivery` → отображается как "Наличными при получении"
- `credit_card` → отображается как "Банковской картой"

**Способы доставки:**
- `express_delivery` → отображается как "Экспресс-доставка"
- `pickup` → отображается как "Самовывоз"
- `standard_delivery` → отображается как "Стандартная доставка"

При создании новых заказов система автоматически нормализует значения:
- `cash_on_delivery` → `cash`
- `credit_card` → `card`
- `bank_transfer` → `transfer`
- `express_delivery` → `courier`
- `standard_delivery` → `transport`

### 2. Пути к изображениям

В БД пути к изображениям хранятся как `/storage/images/...`. Система автоматически обрабатывает оба формата:
- `/storage/images/file.jpg` → корректно отображается
- `product_images/file.jpg` → также корректно отображается

### 3. Структура данных

Все существующие данные полностью совместимы:
- ✅ Категории (включая иерархию)
- ✅ Товары с техническими характеристиками (JSON)
- ✅ Заказы со всеми статусами
- ✅ Позиции заказов
- ✅ Пользователи (админ и клиенты)
- ✅ Изображения товаров

### 4. Пароли пользователей

В БД пароли хранятся в хешированном виде. Для входа используйте:
- **Администратор**: `admin@arviay.ru` / пароль из БД (если нужно, можно сбросить через `php artisan tinker`)

### 5. Рекомендации

1. **Обновление паролей**: Рекомендуется обновить пароли пользователей для безопасности:
   ```php
   // В tinker: php artisan tinker
   $user = User::find(1);
   $user->password = Hash::make('новый_пароль');
   $user->save();
   ```

2. **Проверка изображений**: Убедитесь, что файлы изображений находятся в правильных директориях:
   - `storage/app/public/images/` для путей `/storage/images/...`
   - Или обновите пути в БД на `product_images/...`

3. **Миграция данных**: Если хотите привести все значения к новому формату, можно создать миграцию данных:
   ```php
   // Обновить старые значения payment_method и delivery_method
   DB::table('orders')->where('payment_method', 'cash_on_delivery')
       ->update(['payment_method' => 'cash']);
   // и т.д.
   ```

### 6. Тестирование

После обновления кода проверьте:
- ✅ Отображение заказов (старые и новые)
- ✅ Создание новых заказов
- ✅ Отображение изображений товаров
- ✅ Работу админ-панели
- ✅ Фильтрацию заказов по статусам

