# Настройка email-уведомлений

## Описание

Система автоматически отправляет email-уведомления клиентам при изменении статуса заказа.

## Настройка почты

### Вариант 1: Использование log драйвера (для разработки)

По умолчанию Laravel использует `log` драйвер, который записывает письма в файл `storage/logs/laravel.log`.

В файле `.env`:
```env
MAIL_MAILER=log
```

### Вариант 2: SMTP (для продакшена)

В файле `.env` укажите настройки вашего SMTP-сервера:

```env
MAIL_MAILER=smtp
MAIL_HOST=smtp.example.com
MAIL_PORT=587
MAIL_USERNAME=your-email@example.com
MAIL_PASSWORD=your-password
MAIL_ENCRYPTION=tls
MAIL_FROM_ADDRESS=noreply@arviay.ru
MAIL_FROM_NAME="${APP_NAME}"
```

### Вариант 3: Mailgun, Postmark и другие

Laravel поддерживает различные почтовые сервисы. См. документацию Laravel для настройки.

## Когда отправляются уведомления

Уведомления отправляются автоматически при изменении статуса заказа администратором:
- Новый → В обработке
- В обработке → Выполнен
- В обработке → Отменен
- и т.д.

## Получатели уведомлений

1. **Зарегистрированные пользователи**: Уведомление отправляется на email, указанный при регистрации
2. **Гостевые заказы**: Уведомление отправляется на email из поля `customer_details` (если указан)

## Проверка работы

1. Создайте тестовый заказ
2. В админ-панели измените статус заказа
3. Проверьте:
   - Если `MAIL_MAILER=log`: проверьте файл `storage/logs/laravel.log`
   - Если настроен SMTP: проверьте почтовый ящик клиента

## Отключение уведомлений

Если нужно временно отключить отправку уведомлений, закомментируйте соответствующий код в `app/Http/Controllers/Admin/AdminController.php` в методе `updateOrderStatus()`.

