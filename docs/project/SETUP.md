# Инструкция по настройке проекта АО «Арвиай»

## Требования
- PHP 8.1+
- MySQL 5.7+ или MariaDB 10.3+
- Composer
- Node.js и NPM (для фронтенда)

## Шаги установки

### 1. Настройка базы данных

Создайте базу данных MySQL:

```sql
CREATE DATABASE IF NOT EXISTS `arviay_shop` 
CHARACTER SET utf8mb4 
COLLATE utf8mb4_unicode_ci;
```

### 2. Настройка .env файла

Откройте файл `.env` и настройте подключение к базе данных:

```env
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=arviay_shop
DB_USERNAME=ваш_пользователь
DB_PASSWORD=ваш_пароль
```

### 3. Установка зависимостей

```bash
composer install
npm install
```

### 4. Генерация ключа приложения

```bash
php artisan key:generate
```

### 5. Запуск миграций

```bash
php artisan migrate
```

### 6. Заполнение базы данных тестовыми данными

```bash
php artisan db:seed
```

После выполнения команды будут созданы:
- **Администратор**: 
  - Email: `admin@arviay.ru`
  - Пароль: `admin123`
  
- **Тестовый клиент**:
  - Email: `client@arviay.ru`
  - Пароль: `client123`

- **Категории товаров** (4 основные + 2 подкатегории)
- **8 товаров** с полными характеристиками

### 7. Сборка фронтенда

```bash
npm run build
```

Или для разработки:

```bash
npm run dev
```

### 8. Запуск сервера разработки

```bash
php artisan serve
```

Сайт будет доступен по адресу: `http://localhost:8000`

## Структура проекта

### Основные маршруты:
- `/` - Главная страница (для гостей)
- `/login` - Вход в систему
- `/register` - Регистрация
- `/dashboard` - Каталог товаров (требует авторизации)
- `/cart` - Корзина
- `/checkout` - Оформление заказа
- `/orders` - История заказов
- `/admin/dashboard` - Админ-панель
- `/admin/orders` - Управление заказами

### Роли пользователей:
- **admin** - Администратор (доступ к админ-панели)
- **client** - Клиент (доступ к каталогу и заказам)

## Особенности

1. **Иерархические категории** - поддержка родительских и дочерних категорий
2. **Артикулы товаров** - каждый товар имеет уникальный SKU для интеграции с 1С
3. **Остатки на складе** - автоматическое управление остатками при оформлении заказов
4. **Технические характеристики** - JSON поле для гибкого хранения характеристик
5. **Статусы заказов** - new, processing, completed, cancelled
6. **Способы оплаты** - наличные, карта, банковский перевод
7. **Способы доставки** - самовывоз, курьер, транспортная компания

## Интеграция с 1С

В таблице `orders` есть поле `is_synced_to_1c` для отслеживания синхронизации заказов с системой 1С.

## Загрузка изображений

Изображения товаров хранятся в `storage/app/public/product_images/` и доступны через симлинк `public/storage`.

## Дополнительные команды

Очистка кэша:
```bash
php artisan cache:clear
php artisan config:clear
php artisan view:clear
```

Сброс базы данных (ОСТОРОЖНО! Удалит все данные):
```bash
php artisan migrate:fresh --seed
```

